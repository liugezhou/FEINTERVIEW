## 29 | HTTP/1：HTTP 性能优化

### 超文本传输协议 HTTP/0.9

> HTTP/0.9 是在 1991 年提出。
> 主要用于学术交流-在网络之间传递 HTML 超文本内容，所以被称为超文本传输协议(HyperText Transfer Protocol)。  
> 过程是：客户端根据 IP 地址、端口号和服务器建立 TCP 连接，建立连接后，发送一个 GET 请求行消息来获取 html，服务器接收到这个 Get 请求，将数据以 ASCII 字符流返回给客户端，html 传输完成，断开连接。  
> 特点是：只有一个请求行，没有 HTTP 请求头和请求体；服务器也没有返回头信息，只有返回的数据；返回的文件内容是以 ASCII 字符流来传输的。

### 被浏览器推动的 HTTP/1.0

> 新兴网络的发展，浏览器需要展示的内容不单单是 HTML 文件，还有 JS、CSS、图片、音频、视频等不同类型的文件，也就是说 HTTP1.0 的核心诉求就是要支持多种类型的文件下载，且文件格式不再局限于 ASCII 编码了。  
> 为了满足多种类型文件的传输，HTTP/1.0 引入了请求头和响应头。  
> 请求头的内容有：服务器返回的文件类型、文件压缩方式、提供什么语言文件、文件的具体编码：

```
accept: text/html
accept-encoding: gzip, deflate, br
accept-Charset: ISO-8859-1,utf-8
accept-language: zh-CN,zh
```

> 除了对多文件的增强外，还根据实际需求引入了几个新增的典型特性：
>
> - 引入了**状态码 **
> - 为了减轻服务器压力，HTTP/1.0 提供了 Cache 机制，用来缓存下载过的数据
> - 在请求头中加入了**用户代理**的字段(为了统计客户端的信息--比如Windows和MacOS用户数量为多少)

### 缝缝补补的HTTP/1.1

#### 改进持久性连接
> 一个页面可能包含几百个外部资源文件，为了解决每次下载都需要建立TCP连接，HTTP/1.1中增加了持久性连接的方法，特点是可以在一个TCP连接上传输多个HTTP请求，只要浏览器或者服务器没有明确断开连接，那么持久性连接就会使得该TCP连接一直保持。   
> 然后，这么做就减少了服务器的负担，提升了HTTP的请求时长，他的持久性连接是默认开启的，如果想关闭通过Connection:close。  
> 目前，浏览器对于同一个域名，默认允许建立6个TCP持久连接。  
> 如果想增加TCP的连接，可以使用一种叫做域名分片的技术：把该站点下面的资源放在多个域名下。

#### 不成熟的HTTP管线化
> 